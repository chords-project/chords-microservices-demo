/*
 * This source file was generated by the Gradle 'init' task
 */
package dev.chords.microservices.benchmark;

import choral.reactive.tracing.JaegerConfiguration;

public class Benchmark {

    public static void main(String[] args) throws Exception {

        final String SERVICE_A = "localhost:8201";
        final String SERVICE_B = "localhost:8202";

        final String JAEGER_ENDPOINT = "http://localhost:4317";

        GrpcServer grpcServer = new GrpcServer();
        grpcServer.start(5430);

        ServiceA serviceA = new ServiceA(JaegerConfiguration.initTelemetry(JAEGER_ENDPOINT, "ServiceA"), SERVICE_B);
        ServiceB serviceB = new ServiceB(JaegerConfiguration.initTelemetry(JAEGER_ENDPOINT, "ServiceB"), SERVICE_A);

        serviceA.listen(SERVICE_A);
        serviceB.listen(SERVICE_B);

        // serviceA.startPingPong();
        // serviceA.startPingPong();
        // serviceA.startPingPong();

        serviceA.startGreeting();

        serviceA.close();
        serviceB.close();
        grpcServer.stop();
    }
}
